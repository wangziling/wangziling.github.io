(()=>{console.log(`\n %c Hexo theme Stellaris %c ${stellar.github} %c \n \n`,"color: #eff4f9; background: #030307; padding: 5px; border-radius: 4px 0 0 4px;","background: #eff4f9; padding: 5px; border-radius: 0 4px 4px 0;","");console.log("By Kirikaze Chiyuki")})();const util={diffDate:(e,t=false)=>{const l=new Date;const s=new Date(e);const a=l.getTime()-s.getTime();const i=1e3*60;const n=i*60;const r=n*24;const o=r*30;let c;if(t){const d=a/o;const u=a/r;const f=a/n;const g=a/i;if(d>12){c=null}else if(d>=1){c=parseInt(d)+" "+stellar.config.date_suffix.month}else if(u>=1){c=parseInt(u)+" "+stellar.config.date_suffix.day}else if(f>=1){c=parseInt(f)+" "+stellar.config.date_suffix.hour}else if(g>=1){c=parseInt(g)+" "+stellar.config.date_suffix.min}else{c=stellar.config.date_suffix.just}}else{c=parseInt(a/r)}return c},copy:(e,t)=>{const l=document.getElementById(e);if(l){l.select();document.execCommand("Copy");if(t&&t.length>0){hud.toast(t)}}},toggle:e=>{const t=document.getElementById(e);if(t){t.classList.toggle("display")}}};const hud={toast:(e,t)=>{t=isNaN(t)?2e3:t;var l=document.createElement("div");l.classList.add("toast");l.innerHTML=e;document.body.appendChild(l);setTimeout(function(){var e=.5;l.style.webkitTransition="-webkit-transform "+e+"s ease-in, opacity "+e+"s ease-in";l.style.opacity="0";setTimeout(function(){document.body.removeChild(l)},e*1e3)},t)}};const sidebar={toggle:()=>{const e=document.querySelector(".l_body");if(e){e.classList.add("mobile");e.classList.toggle("sidebar")}}};const stellaris={themePlugins:{},registerThemePlugin:function(e,t){this.themePlugins[e]=t;stellaris.jQuery(()=>$(()=>{t.init()}))},pluginsConfig:{fancyBoxSelector:""},jQuery(e){const{status:t}=stellaris.jQueryState;if(typeof window.jQuery!=="undefined"||t==="loaded"){e()}else if(t==="loading"){stellaris.jQueryState.promise.then(e)}else{stellaris.jQueryState.status="loading";stellaris.jQueryState.promise=stellar.loadScript(stellar.plugins.jQuery).then(()=>{stellaris.jQueryState.status="loaded"}).then(e)}},jQueryState:{status:"none",promise:null},loadCSS:{fancyBox:()=>{if(stellar.plugins.fancybox)stellar.loadCSS(stellar.plugins.fancybox.css)},swiper:()=>{if(stellar.plugins.swiper)stellar.loadCSS(stellar.plugins.swiper.css)}},load:{swiper:()=>{if(stellar.plugins.swiper){const e=document.getElementById("swiper-api");if(e!=undefined){stellar.loadCSS(stellar.plugins.swiper.css);stellar.loadScript(stellar.plugins.swiper.js,{defer:true}).then(stellaris.init.swiper)}}},scrollReveal:()=>{if(stellar.plugins.scrollreveal){stellar.loadScript(stellar.plugins.scrollreveal.js).then(stellaris.init.scrollReveal)}},lazyLoad:()=>{if(stellar.plugins.lazyload){stellar.loadScript(stellar.plugins.lazyload.js,{defer:true});window.lazyLoadOptions={elements_selector:".lazy"};window.addEventListener("LazyLoad::Initialized",e=>{window.lazyLoadInstance=e.detail.instance},false);stellaris.init.lazyLoad()}},fancyBox:()=>{if(stellar.plugins.fancybox){let e="img[fancybox]:not(.error)";if(stellar.plugins.fancybox.selector){e+=`, ${stellar.plugins.fancybox.selector}`}stellaris.pluginsConfig.fancyBoxSelector=e;stellar.loadCSS(stellar.plugins.fancybox.css);stellar.loadScript(stellar.plugins.fancybox.js,{defer:true}).then(stellaris.init.fancyBox)}},search:()=>{if(stellar.search.service&&stellar.search.service=="local_search"){stellar.loadScript(stellar.search.js,{defer:true}).then(stellaris.init.search)}},copyCode:()=>{if(stellar.plugins.copycode){stellar.loadScript(stellar.plugins.copycode.js,{defer:true})}},themePlugins:()=>{if(stellar.plugins.stellar){for(let e of Object.keys(stellar.plugins.stellar)){stellar.loadScript(stellar.plugins.stellar[e],{defer:true});if(e=="timeline"){stellar.loadScript(stellar.plugins.marked)}}}}},loadNeededCSS:()=>{["fancyBox","swiper"].forEach(e=>{stellaris.loadCSS[e]()})},loadAllPlugins:()=>{["scrollReveal","lazyLoad","fancyBox","swiper","search","copyCode","themePlugins"].forEach(e=>{stellaris.load[e]()})},loadNeededPlugins:()=>{["lazyLoad","fancyBox","swiper"].forEach(e=>{stellaris.load[e]()})},init:{toc:()=>{stellaris.jQuery(()=>{const f=32;var g=[];$("article.md-text :header").each(function(e,t){g.push(t)});$(document,window).scroll(function(e){var t=$(this).scrollTop();var l=null;for(var s in g){var a=$(g[s]);if(a.offset().top>t+f){continue}if(!l){l=a}else if(a.offset().top>=l.offset().top){l=a}}if(l){$(".toc#toc a.toc-link").removeClass("active");var i="#"+l.attr("id");if(i!="#undefined"){const n='.toc#toc a.toc-link[href="'+encodeURI(i)+'"]';const r=$(n);if(r.length>0){r.addClass("active");const o=document.querySelector(".widgets");const c=document.querySelector(n);const d=c.getBoundingClientRect().bottom-o.getBoundingClientRect().bottom+200;const u=c.getBoundingClientRect().top-o.getBoundingClientRect().top-64;if(u<0){o.scrollBy(0,u)}else if(d>0){o.scrollBy(0,d)}}}else{$(".toc#toc a.toc-link:first").addClass("active")}}})})},sidebar:()=>{stellaris.jQuery(()=>{$(".toc#toc a.toc-link").click(function(e){const t=document.querySelector(".l_body");t.classList.remove("sidebar")})})},clickEvents:()=>{stellaris.jQuery(()=>{const l=$(".on-click-event");l.each(e=>{const t=$(l[e]);t.attr("onclick",t.attr("data-on-click"));t.removeAttr("data-on-click")})})},relativeDate:()=>{document.querySelectorAll("#post-meta time").forEach(e=>{const t=e;const l=t.getAttribute("datetime");let s=util.diffDate(l,true);if(s){t.innerText=s}})},registerTabsTag:function(){document.querySelectorAll(".tabs .nav-tabs .tab").forEach(l=>{l.addEventListener("click",e=>{e.preventDefault();if(l.classList.contains("active"))return;[...l.parentNode.children].forEach(e=>{e.classList.toggle("active",e===l)});const t=document.getElementById(l.querySelector("a").getAttribute("href").replace("#",""));[...t.parentNode.children].forEach(e=>{e.classList.toggle("active",e===t)});t.dispatchEvent(new Event("tabs:click",{bubbles:true}))})});window.dispatchEvent(new Event("tabs:register"))},outdatedCheck:()=>{if(stellar.article.outdate_month==0)return;const e=document.getElementById("outdated");if(!e)return;const t=(e,t)=>{if(t.getFullYear()-e.getFullYear()>0){return true}else{return t.getMonth()-e.getMonth()>stellar.article.outdate_month}};const l=document.getElementById("post-meta").getElementsByTagName("time");if(e!==null){if(t(new Date(l[l.length-1].dateTime),new Date)){e.innerText="，文章内容可能已经过时"}}},search:()=>{if(stellar.search.service&&stellar.search.service=="local_search"){stellaris.jQuery(()=>{const l=$("input#search-input");if(l.length==0){return}l.focus(function(){let e;if(stellar.search.service in stellar.search){e=stellar.search[stellar.search.service].path}else{e="/search.json"}if(!e.startsWith("/")){e="/"+e}const t=l.attr("data-filter")||"";searchFunc(e,t,"search-input","search-result")});l.keydown(function(e){if(e.which==13){e.preventDefault()}});new MutationObserver(function(e,t){if(e.length==1){if(e[0].addedNodes.length){$(".search-wrapper").removeClass("noresult")}else if(e[0].removedNodes.length){$(".search-wrapper").addClass("noresult")}}}).observe(document.querySelector("div#search-result"),{childList:true})})}},swiper:()=>{if(stellar.plugins.swiper&&"Swiper"in window){const e=swiper_api.getAttribute("effect")||"";window.swiper=new Swiper(".swiper#swiper-api",{slidesPerView:"auto",spaceBetween:8,centeredSlides:true,effect:e,loop:true,pagination:{el:".swiper-pagination",clickable:true},navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"}})}},scrollReveal:()=>{if(stellar.plugins.scrollreveal&&"ScrollReveal"in window){const e="body .reveal",t=window.ScrollReveal();t.destroy();document.querySelectorAll(e).forEach(t=>{["opacity","transform"].forEach(e=>{t.style[e]=null})});const{distance:l,duration:s,interval:a,scale:i}=stellar.plugins.scrollreveal;setTimeout(()=>{t.reveal(e,{distance:l,duration:s,interval:a,scale:i,easing:"ease-out"})},50)}},lazyLoad:()=>{if(stellar.plugins.lazyload&&"lazyLoadInstance"in window){window.lazyLoadInstance.update()}},fancyBox:()=>{if(stellar.plugins.fancybox&&"Fancybox"in window){const e=stellaris.pluginsConfig.fancyBoxSelector;if(document.querySelectorAll(e).length!==0){Fancybox.bind(e,{groupAll:true,hideScrollbar:false,Thumbs:{autoStart:false},caption:function(e,t,l){return l.$trigger.alt||null}})}}},themePlugins:()=>{if(stellar.plugins.stellar){Object.keys(stellaris.themePlugins).forEach(e=>{const t=document.querySelectorAll(e);if(t!=undefined&&t.length>0){stellaris.jQuery(()=>$(()=>{stellaris.themePlugins[e].init()}))}})}}},initPageComponents:()=>{["toc","sidebar","clickEvents","relativeDate","registerTabsTag","outdatedCheck"].forEach(e=>{stellaris.init[e]()})},initPlugins:()=>{["scrollReveal","lazyLoad","fancyBox","swiper","search","themePlugins"].forEach(e=>{stellaris.init[e]()})},initOnFirstLoad:()=>{console.log(`New page loaded: ${window.location.pathname}`);stellaris.loadNeededPlugins();stellaris.initPageComponents()},initOnPageChange:()=>{console.log(`Page loaded: ${window.location.pathname}`);stellaris.loadNeededCSS();stellaris.loadNeededPlugins();stellaris.initPageComponents();stellaris.initPlugins()}};window.addEventListener("load",stellaris.loadAllPlugins,false);window.addEventListener("load",stellaris.initOnFirstLoad,false);InstantClick.on("change",stellaris.initOnPageChange);
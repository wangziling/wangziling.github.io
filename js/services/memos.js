utils.jq((()=>{$((function(){const e=document.getElementsByClassName("ds-memos");for(var t=0;t<e.length;t++){const i=e[t],s=i.getAttribute("api");if(null==s)continue;const a=i.getAttribute("avatar")||def.avatar,n=i.getAttribute("limit"),r=s.replace(/https:\/\/(.*?)\/(.*)/i,"$1");utils.request(i,s,(function(e){var t=[];const s=i.getAttribute("user");s&&s.length>0&&(t=s.split(","));var l=[];const c=i.getAttribute("hide");c&&c.length>0&&(l=c.split(",")),e.forEach(((e,s)=>{if(n&&s>=n)return;if(e.user&&e.user.login&&t.length>0&&!t.includes(e.user.login))return;let c=new Date(1e3*e.createdTs);var d='<div class="timenode" index="'+s+'">';d+='<div class="header">',t.length||l.includes("user")||(d+='<div class="user-info">',a.length>0&&(d+=`<img src="${a}">`),d+="<span>"+e.creatorName+"</span>",d+="</div>"),d+="<span>"+c.toLocaleString()+"</span>",d+="</div>",d+='<div class="body">',d+=marked.parse(e.content||"");var o=[];for(let t of e.resourceList)t.type?.includes("image/")&&o.push(t);if(o.length>0){d+='<div class="tag-plugin image">';for(let e of o)e.externalLink?.length>0?d+=`<div class="image-bg"><img src="${e.externalLink}" data-fancybox="memos"></div>`:d+=`<div class="image-bg"><img src="https://${r}/o/r/${e.id}" data-fancybox="memos"></div>`;d+="</div>"}d+="</div>",d+="</div>",$(i).append(d)}))}))}}))}));
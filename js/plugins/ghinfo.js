(()=>{const t={requestAPI:(t,e,n)=>{let i=5;!function o(){return new Promise(((l,s)=>{let r=0,u=setTimeout((()=>{0===r&&(r=2,u=null,s("请求超时"),0==i&&n())}),5e3);fetch(t).then((function(t){if(2!==r&&(clearTimeout(u),l(t),u=null,r=1),t.ok)return t.json();throw new Error("Network response was not ok.")})).then((function(t){i=0,e(t)})).catch((function(t){i>0?(i-=1,setTimeout((()=>{o()}),5e3)):n()}))}))}()},layout:function(t){const e=$(t.el)[0];function n(t){for(let n of Object.keys(t))$(e).find("[type=text]#"+n).text(t[n]),$(e).find("[type=link]#"+n).attr("href",t[n]),$(e).find("[type=img]#"+n).attr("src",t[n])}this.requestAPI(t.api,(function(t){const i=e.getAttribute("index");if(null!=i){const e=t.content||t;if(e&&e.length>i){let t=e[i];t["latest-tag-name"]=t.name,n(e[i])}}else n(t)}),(function(){}))},init:function(){const t=document.getElementsByClassName("stellar-ghinfo-api");for(let e=0;e<t.length;e++){const n=t[e],i=n.getAttribute("api");null!=i&&this.layout({el:n,api:i,class:n.getAttribute("class")})}}};stellaris.registerThemePlugin(".stellar-ghinfo-api",t)})();
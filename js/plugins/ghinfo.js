(()=>{const t={requestAPI:(o,s,l)=>{let f=5;function r(){return new Promise((e,t)=>{let n=0;let i=setTimeout(()=>{if(n===0){n=2;i=null;t("请求超时");if(f==0){l()}}},5e3);fetch(o).then(function(t){if(n!==2){clearTimeout(i);e(t);i=null;n=1}if(t.ok){return t.json()}throw new Error("Network response was not ok.")}).then(function(t){f=0;s(t)}).catch(function(t){if(f>0){f-=1;setTimeout(()=>{r()},5e3)}else{l()}})})}r()},layout:function(t){const i=$(t.el)[0];function o(e){for(let t of Object.keys(e)){$(i).find("[type=text]#"+t).text(e[t]);$(i).find("[type=link]#"+t).attr("href",e[t]);$(i).find("[type=img]#"+t).attr("src",e[t])}}this.requestAPI(t.api,function(t){const e=i.getAttribute("index");if(e!=undefined){const n=t.content||t;if(n&&n.length>e){let t=n[e];t["latest-tag-name"]=t["name"];o(n[e])}}else{o(t)}},function(){})},init:function(){const e=document.getElementsByClassName("stellar-ghinfo-api");for(let t=0;t<e.length;t++){const n=e[t];const i=n.getAttribute("api");if(i==null){continue}this.layout({el:n,api:i,class:n.getAttribute("class")})}}};stellaris.registerThemePlugin(".stellar-ghinfo-api",t)})();